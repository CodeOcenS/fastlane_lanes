desc 'ä½¿ç”¨è¿™ä¸ªèˆªé“, å¯ä»¥å¿«é€Ÿçš„å¯¹è‡ªå·±çš„ç§æœ‰åº“, è¿›è¡Œå‡çº§ç»´æŠ¤'
lane :UpdateLib do |options|

tagName = options[:tag]
targetName = options[:target]
updateMessage = options[:message]


# å…·ä½“è¿™ä¸ªå··é“ä¸Šé¢æ‰§è¡Œå“ªäº›è¡Œä¸º

# 1. pod install
cocoapods(
clean: true,
podfile: "./Example/Podfile"
)

# 2. git add .
git_add(path: ".")
#    git commit -m 'xxx'
git_commit(path: ".", message: updateMessage)
#    git push origin master
push_to_git_remote

# éªŒè¯tagæ˜¯å¦å­˜åœ¨,å¦‚æœå­˜åœ¨, åº”è¯¥åˆ é™¤æœ¬åœ°æ ‡ç­¾å’Œè¿œç¨‹æ ‡ç­¾
#if åˆ¤æ–­æ ‡ç­¾æ˜¯å¦å­˜åœ¨
#    æ‰§è¡Œåˆ é™¤æœ¬åœ°/è¿œç¨‹æ ‡ç­¾
#end

#if git_tag_exists(tag: tagName)
#    UI.message("å‘ç°tag:#{tagName} å·²ç»å­˜åœ¨, å³å°†æ‰§è¡Œ, åˆ é™¤åŠ¨ä½œ ğŸš€")
#    remove_tag(tag:tagName)
#end


# 3. git tag æ ‡ç­¾åç§°
add_git_tag(
tag: tagName
)
#    git push --tags
push_git_tags

# æ”¹å˜pedspec version
version_bump_podspec(path:"#{targetName}.podspec", version_number: tagName)

#4. pod spec lint
pod_lib_lint(allow_warnings: true)
#5. pod repo push XXXX xxx.podspec
pod_push(path: "#{targetName}.podspec", allow_warnings: true) # , repo: "XMGFMSpecs"
 

end